import numpy as np
from linear_regression import simple_linear_regression, pred_and_r2
from pytest import approx



def test_two_point() :
    reg = simple_linear_regression([1., 3.], [1.,6.])
    assert reg(0) == approx(-1.5, .00001)
    assert reg(-17.25) == approx(-44.625, .00001)
    assert reg(.0125) == approx(-1.46875, .00001)
    assert reg(10.) == approx(23.5, .00001)

def test_random_narrow() :
    X_train = np.array([31.09718176, 11.49393277, 82.87068924, 52.53908447,
                        10.85941503, 75.89644706, 35.07045859, 95.01202389,
                        88.24855559, 30.5827398, 94.99240251, 70.17437378,
                        23.01502362, 23.32142602, 57.88554845, 54.43228815,
                        33.40995295, 43.15200121, 21.38108739, 76.58319351])
    X_test = np.array([85.27654387, 14.83493438, 67.81191225, 33.03540491, 97.72112611])
    Y_train = np.array([123.44791196,  49.85138296, 317.22956204, 201.47549079,
                        49.34588222, 291.3879082 , 136.76426225, 361.37012301,
                        336.72348086, 119.77977897, 362.81432549, 268.65120246,
                        91.93687088,  93.60028187, 222.36498929, 209.78743166,
                        130.91024917, 167.81455603,  86.78583274, 291.91150252])
    Y_test = np.array([325.28045055,  63.01421948, 260.1688166 , 129.1824827, 371.29891902])
    reg = simple_linear_regression(X_train, Y_train)
    assert pred_and_r2(reg, X_test, Y_test) == approx(1, .01)
    
def test_random_wide() :
    X_train = np.array([89.46579857, 96.96355364, 49.95500373, 40.028402  , 94.50832373,
                        26.92855832,  4.1353899 , 10.23040426, 95.86591063, 72.9483642,
                        67.23376418, 76.97644536, 82.20120898, 81.5864408 , 47.31772062,
                        37.94560155, 75.5567851 , 33.97794735, 56.29864808, 36.73509501])
    X_test = np.array([57.91354794,  8.82959281, 10.84515509, 51.00101009, 18.86962556])
    Y_train = np.array([-446.33709469, -516.99669249, -229.68042057, -139.66005888,
                        -438.40283118, -107.1202987 ,  175.72832788,   20.23747085,
                        -565.84869673, -297.74609114, -301.67742102, -392.51882357,
                        -390.69926471, -396.09096714, -149.07659226, -202.16666663,
                        -335.66869169,  -84.27906187, -208.80686052,  -60.93179556])
    Y_test = np.array([-2.22160645e+02,  1.30342428e+02,  8.31895751e+01, -2.08352537e+02, -8.97408883e-02])
    reg = simple_linear_regression(X_train, Y_train)
    assert pred_and_r2(reg, X_test, Y_test) == approx(1, .3)
    
